\documentclass[submission,copyright,creativecommons]{eptcs}
\providecommand{\event}{SynCoP 2014} % Name of the event you are submitting to
\usepackage{breakurl}             % Not needed if you use pdflatex only.

\title{Setting parameters for biological models with ANIMO}
\author{Stefano Schivo
\institute{Formal Methods and Tools\\
Faculty of EEMCS\\
University of Twente\\
Enschede, The Netherlands}
\email{s.schivo@utwente.nl}
\and
Jetse Scholma \quad Marcel Karperien \quad Janine N. Post
\institute{Developmental BioEngineering\\
MIRA Institute for Biomedical Technology and Technical Medicine\\
University of Twente\\
Enschede, The Netherlands}
%\email{\quad j.scholma@utwente.nl \quad h.b.j.karperien@utwente.nl \quad j.n.post@utwente.nl}
\email{\{j.scholma, h.b.j.karperien, j.n.post\}@utwente.nl}
\and
Jaco van de Pol \quad Rom Langerak\thanks{Corresponding author}
\institute{Formal Methods and Tools\\
Faculty of EEMCS\\
University of Twente\\
Enschede, The Netherlands}
%\email{\quad j.c.vandepol@utwente.nl \quad r.langerak@utwente.nl}
\email{\{j.c.vandepol, r.langerak\}@utwente.nl}
}
\def\titlerunning{Setting parameters for biological models with ANIMO}
\def\authorrunning{S. Schivo, J. Scholma, M. Karperien, J. N. Post, J. van de Pol and R. Langerak}
\begin{document}
\maketitle

\begin{abstract}
ANIMO (Analysis of Networks with Interactive MOdeling) is a software for modeling biological networks, such as e.g. signaling, metabolic or gene networks.
An ANIMO model is essentially the sum of a network topology and a number of interaction parameters. The topology describes the interactions between biological entities in form of a graph, while the parameters determine the speed of occurrence of such interactions.

When a mismatch is observed between the behavior of an ANIMO model and experimental data, we want to update the model so that it explains the new data. In general, the topology of a model can be expanded with new (known or hypothetical) players, and enable it to match experimental data. However, the unrestrained addition of new parts to a model causes two problems: models can become too complex too fast, to the point of being intractable, and too many parts marked as "hypothetical" or "not known" make a model unrealistic. Even if changing the topology is normally the easier task, these problems push us to try a better parameter fit as a first step, and resort to modifying the model topology only as a last resource.

In this paper we show the support added in ANIMO to ease the task of expanding the knowledge on biological networks, concentrating in particular on the parameter settings.
\end{abstract}

% ANIMO does not put much stress on parameter settings: the focus of the tool is more on the network topology as the main influence for the behavior of the network.
% However, parameters do have their influence on the behavior of a model: see small example network with different parameters here (tipo Gene).
% While we assume that biological networks are normally robust (difference between individuals, yet same overall behavior. Also cite
%  papers on biological network robustness), a search on the parameter space needs to be performed to explore different behaviors of
%  of the same network.
%  Thanks to the assumption of robustness, we don't need to perform an extremely careful parameter search.
%  Only if such a (reasonably detailed) search does not lead to a model fitting the (new) data at hand should
%  we update/change the topology, adding new or hypothetical nodes that would allow us to explain a behavior that could not otherwise be
%  captured in the model.
% To profit better from the tool, we suggest this workflow:
% - define a starting topology, based on literature
% - set interaction rates with qualitative values, based on experience (e.g., protein expression is much slower than phosphorylation)
% - check that the network behaves as expected (e.g. addition of Wnt makes Bcatenin rapidly increase)
% - possibly iterate these first steps until the network behaves as expected
% - compare the model with experimental data
% - use more refined parameter settings, possibly performing some parameter sweeps
% - if it seems likely that the model will not be easily adapted to the data (or it looks similar to the data only with
%   very narrow ranges of parameters), profit from ANIMO's user friendliness and ``play'' with the network topology,
%   possibly introducing more nodes (from literature or hypothetical: we advise to let expert biologists perform this step on their own,
%   or to perform it under their supervision, in order to keep the network both simple and realistic. For the same reason, we also advise not to introduce more than a couple of nodes
%   at a time) and checking which changes to the topology/parameters induce the most useful changes in model behavior (possibly looking at the
%   differences between two versions of the network) until a result is obtained that is closer to experimental data. Go back to the more precise parameter fitting step.
% - at some point, a model that fits the data reasonably well is obtained: it may contain some hypothetical nodes, or unexpected parts of the network.
% Future experiments can be derived directly from the hypotheses introduced in the model. This process also allows the biologists to formalize their knowledge
% and makes it easier to have group discussions when trying to combine multiple subnetworks in a more comprehensive model.

% - computational modeling in biology
% - assumption of robustness
% - ANIMO, piccolo esempio. ANIMO focuses on topology.
\section{Introduction}
The investigation of biological processes relies on computational support on a daily basis.
This happens not only because of the extremely large amount of data generated in the \emph{-omics era},
but also because many processes are simply too complex to be understood by the human brain alone.
For this reason, systems biology has become more and more important in the last several years.

A single biological network such as a signaling or gene network, may involve up to hundreds of
different players. As it would be very difficult to understand the dynamic behavior of such
networks just by looking at their static representations, many tools were built to help the biologists in that sense.
ANIMO (Analysis of Networks with Interactive MOdeling) is one of such tools. Its primary objective is to let the expert biologists
work directly on the formalization of their knowledge, supporting the generation of new insights on the studied processes.
An ANIMO model is formed by two main parts: the network topology and the parameters.
The topology describes which biological components are included in the model, and which are the
interactions we want to represent. The parameters define the rate of occurrence of such interactions,
which are described based on simplified kinetic formulae.

Proteins are normally expressed at different concentrations in different individuals of the same species, and yet the
overall behavior of their biological networks does not differ significantly. This phenomenon has led to the notion that biological
networks are inherently \emph{robust}. In modeling terms, this means that most of the parameters of a model
can vary inside a certain interval without influencing the qualitative behavior of the whole network.
The interactive approach of ANIMO is based on the assumption of robustness, as our tool is mainly aimed at the
development of network models with a focus on the topology.
Ideally, the biologist can ``play'' with the topology of a network, working
more towards matching the qualitative behavior of experimental data, rather than precisely reproducing it.
However, it is not our intention to concentrate exclusively on the network topology:
in many cases a better parameter choice can improve the behavior of a network more than the addition of new components.
Indeed, making an unnecessarily complex model could reduce its usefulness both in terms of analysis
performances and closeness to reality. The first problem is simply due to the complexity of a network,
which would require more and more computational resources to be analysed\footnote{We also refer to the
problem of \emph{state space explosion}: when a model contains too many loosely coupled components,
the set of its possible evolutions grows exponentially, to the point of making it impossible to apply some analysis
techniques.}.
Realism of network models is more related to their
ultimate usefulness: a model that explains a particular behavior very well but contains many nodes marked
as ``unknown'' has little applicability, as its connection with known processes is very loose.
Therefore, it is desirable that a better parameter set is regularly sought for during the design cycle of
a complex biological network model. Some support for parameter choice was already provided in the first versions of ANIMO.
We present here an extended set of tools aimed at achieving a closer fit between ANIMO models and experimental data.
A guideline on how to use these tools to get the best results will also be presented as an ideal workflow.
Thanks to the better awareness on parameter choice gained through this new extension of ANIMO, the biologists
will be able to judge more easily which are the most promising topologies for a network, and thus drive
the experimental research more efficiently.

% - topology - parameters
% - problemi: small example network with parameter variations (also: some parts of a network are more sensitive to parameter variations than others)
\section{ANIMO models}
The starting point of ANIMO is the traditional static representation of biological networks,
which can be easily drawn and managed in softwares like Cytoscape. Indeed, ANIMO was implemented
as a plug-in to Cytoscape, with the aim of adding dynamics to the static representation of biological
networks, and thus allow for analysis on the behavior of such networks. The user interface of ANIMO
can be seen in Figure~\ref{fig:animo-ui}: at the center is the Network panel, where the network
model is represented in the familiar nodes-edges form used in the domain of biology.
Models in ANIMO are \emph{activity-based}, in the sense that nodes have their activity as main
property, and interactions among nodes change the activity of their targets. The concept of activity
can be intended for example as a generic post-translational modification a molecule can undergo to change its
function. In the case of a kinase, the phosphorylated state is usually interpreted as active.
In the context of a gene network, the activity of a node standing for a gene represents its current
transcriptional status. A basic type of analysis that can be performed with ANIMO is the generation of
a simulation run, which is presented to the user in the form of a graph (to the right). The activity
graphs generated by ANIMO show the variation in activity of selected nodes over the course of the simulation run.
In addition to that, a slider placed under each graph allows the user to color the nodes in the Network panel
depending on their activity level at any point during the course of the simulation: the Legend
panel on the left links colors to activity.

Of the two main components of an ANIMO model, only the topology is immediately visible to the user in the
Network panel; the parameters are accessed by double clicking the arcs representing node-node interactions.
The dialog window that is shown for an interaction contains the details of the abstract reaction kinetic
describing the interaction, together with the current value of its parameter $k$ (see Fig.~\ref{fig:animo-edge-ui}).
The unique parameter associated to any interaction in ANIMO is used as a scale factor to make the modelled
reaction occur faster or slower. We also provide the user with pre-set values for
$k$, encouraging an initial qualitative assignment of reaction rates as ``slow'', ``fast'' and so forth.
This approach is based on the assumption that biological networks are inherently robust:
once an acceptable set of parameters is found, a more precise parameter search will generally have
little impact on the fit of a model.
However, as can be seen in the small example in Figure~\ref{fig:small-example-feedback},
robustness does not imply that any parameter choice will do. In particular, network motifs
such as feedback loops make models more dependent on parameter settings.
As biological networks tend to heavily rely on cross-talk, network topologies can rapidly become
complex. Some manual parameter fitting is currently necessary for the more complex ANIMO models.
This work can be slow and error-prone, taking away some of the user-friendliness
for which ANIMO aims.
We will show how ANIMO has been improved to make parameter choice easier for the user.

\begin{figure}
%Show example on parameters of feedback inactivation loop (also the example ABCDE from ANIMO's manual would be ok)
\caption{fig:small-example-feedback}
\end{figure}

% - slow/medium/fast..
% - parameter sweep
% - compare simulations
% Anche come sono fatti (esempio, parameter sweep: la formula dell'errore etc)
\section{Support for parameter synthesis in ANIMO}
When a model does not match experimental data, ANIMO offers three main tools to achieve a better fit:
manual parameter editing, comparisons between different model versions, and the newly introduced parameter sweep.

\subsection{Manual parameter editing}\label{sec:parameter-editing}
Double-clicking on an arrow in the Cytoscape representation of an interaction lets the user access
a dialog that allows to change the approximated scenario and parameters for the selected interaction.
The simplified scenarios were described in~\cite{animo-ieee}, and we explain them briefly here:
\begin{description}
  \item scenario 1
  \item scen 2
  \item scen 3
\end{description}

The choice for the parameter $k$ can be made directly inserting a numeric value, or by choosing
a preset among the proposed qualitative values \emph{very slow, slow, medium, fast, very fast}.
We advise our users to base their initial parameter choice on these qualitative presets.
In Figure~\ref{fig:small-example-feedback}, all parameters are initially set to \emph{medium}
(Fig.~\ref{fig:small-example-feedback}{\sf a}), while the peak in {\sf b} was obtained by setting the
parameter of $C \dashv B$ to \emph{fast} and the parameter of $E \dashv D$ to \emph{slow}.

\subsection{Comparing model versions}\label{sec:comparing-versions}
Particularly large networks make it more difficult for the user to understand the effect
of a change in network topology or interaction parameters. To overcome this difficulty, ANIMO
allows the user to visually compare two versions of a model in terms of their simulation results.
The Results panel in Figure~\ref{animo-ui} shows the graph of selected node activities during
the course of an ANIMO simulation. The button ``Compare with\dots'' allows to compare the current
simulation data with another based on a possibly different version of the model. When the two
simulations to be compared have been chosen, ANIMO produces a new graph plotting the difference
between the two original simulations. The slider under the new graph allows to visualize also
in the Network panel the changes in node activity in the whole network: Figure~\ref{fig:diff}
shows the difference between the two versions of the model in Figure~\ref{fig:small-example-feedback}.
The difference was computed as {\sf b - a}. Nodes colored in green in the Network panel are
more active in version {\sf b}, while red nodes are more active in version {\sf a}.

By changing the title of a simulation, a user can keep track of different versions of their model,
which can be also kept and saved with the model, to be used in future sessions or for sharing purposes.
Should a user want to backtrack to a particular version of the network, the ``Reset to this'' button
can be used. As an additional help to recall what a model version consisted of, the tooltipo of
the ``Reset to this'' button shows an image of the network topology, taken in the moment when
the selected simulation was begun. A click on the ``Reset to this'' button will reset the
network topology and parameters at the ones used to generate the selected simulation.
As the adaptation of a model may proceed on different paths, the ``Compare with\dots'' and
``Reset to this'' buttons provide the user with some help in tracking the changes to the model
and selecting the most promising ones.

\subsection{Parameter sweep}\label{sec:parameter-sweep}
In order to avoid introducing too many changes to the topology of a network, we recommend
ANIMO users to be reasonably sure that a topology does not fit a given data set before
modifying it. As this would entail an extensive parameter search which, even with the tools
described in Sections~\ref{sec:parameter-editing} and~\ref{sec:comparing-versions}, would
require a considerable amount of time and effort, we have provided the latest version of ANIMO
with a support for parameter sweeps. The idea is to let ANIMO explore the user-defined parameter
space by computing a series of simulations based on the same network topology, when only the
parameters are being changed. Comparing the results with a given experimental data series
will let the user select the most promising parameter choices, eventually selecting the one
that behaves the best.
%Multicore!
%log e linear scale
%error vs data --> narrower parameter choices

% dopo aver presentato gli strumenti che forniamo, definiamo una procedura consigliata per usare ANIMO nel modo più efficace.
% Ovviamente, oltre alle best practices serve anche l'esperienza, sia intesa come conoscenza di biologia che come esperienza
% nel campo della modellazione. Nota che non serve comunque conoscenza di T.A., visto che rimangono sempre nascosti dietro la GUI
% Esempio/case study!
\section{Suggested ANIMO workflow}

% anche Related work: es. Copasi
% Altro su parameter sweep/sensitivity analysis? Noi usiamo un approccio un po' naif, senza tante pretese, senza tanti numeri.
\section{Conclusions}

% \section{Bibliography}
% 
% We request that you use
% \href{http://www.cse.unsw.edu.au/~rvg/EPTCS/eptcs.bst}
% {\tt $\backslash$bibliographystyle$\{$eptcs$\}$}
% \cite{bibliographystylewebpage}. Compared to the original {\LaTeX}
% {\tt $\backslash$biblio\-graphystyle$\{$plain$\}$},
% it ignores the field {\tt month}, and uses the extra
% bibtex fields {\tt eid}, {\tt doi}, {\tt ee} and {\tt url}.
% The first is for electronic identifiers (typically the number $n$
% indicating the $n^{\rm th}$ paper in an issue) of papers in electronic
% journals that do not use page numbers. The other three are to refer,
% with life links, to electronic incarnations of the paper.
% 
% Almost all publishers use digital object identifiers (DOIs) as a
% persistent way to locate electronic publications. Prefixing the DOI of
% any paper with {\tt http://dx.doi.org/} yields a URI that resolves to the
% current location (URL) of the response page\footnote{Nowadays, papers
%   that are published electronically tend
%   to have a \emph{response page} that lists the title, authors and
%   abstract of the paper, and links to the actual manifestations of
%   the paper (e.g.\ as {\tt dvi}- or {\tt pdf}-file). Sometimes
%   publishers charge money to access the paper itself, but the response
%   page is always freely available.}
% of that paper. When the location of the response page changes (for
% instance through a merge of publishers), the DOI of the paper remains
% the same and (through an update by the publisher) the corresponding
% URI will then resolve to the new location. For that reason a reference
% ought to contain the DOI of a paper, with a life link to corresponding
% URI, rather than a direct reference or link to the current URL of
% publisher's response page. This is the r\^ole of the bibtex field {\tt doi}.
% DOIs of papers can often be found through
% \url{http://www.crossref.org/guestquery};\footnote{For papers that will appear
%   in EPTCS and use \href{http://www.cse.unsw.edu.au/~rvg/EPTCS/eptcs.bst}
%   {\tt $\backslash$bibliographystyle$\{$eptcs$\}$} there is no need to
%   find DOIs on this website, as EPTCS will look them up for you
%   automatically upon submission of a first version of your paper;
%   these DOIs can then be incorporated in the final version, together
%   with the remaining DOIs that need to found at DBLP or publisher's webpages.}
% the second method {\it Search on article title}, only using the {\bf
% surname} of the first-listed author, works best.  
% Other places to find DOIs are DBLP and the response pages for cited
% papers (maintained by their publishers).
% {\bf EPTCS requires the inclusion of a DOI in each cited paper, when available.}
% 
% Often an official publication is only available against payment, but
% as a courtesy to readers that do not wish to pay, the authors also
% make the paper available free of charge at a repository such as
% \url{arXiv.org}. In such a case it is recommended to also refer and
% link to the URL of the response page of the paper in such a
% repository.  This can be done using the bibtex fields {\tt ee} or {\tt
% url}, which are treated as synonyms.  These fields should not be used
% to duplicate information that is already provided through the DOI of
% the paper.
% You can find archival-quality URL's for most recently published papers
% in DBLP---they are in the bibtex-field {\tt ee}. In fact, it is often
% useful to check your references against DBLP records anyway, or just find
% them there in the first place.
% 
% When using {\LaTeX} rather than {\tt pdflatex} to typeset your paper, by
% default no linebreaking within long URLs is allowed. This leads often
% to very ugly output, that moreover is different from the output
% generated when using {\tt pdflatex}. This problem is repaired when
% invoking \href{http://www.cse.unsw.edu.au/~rvg/EPTCS/breakurl.sty}
% {\tt $\backslash$usepackage$\{$breakurl$\}$}: it allows linebreaking
% within links and yield the same output as obtained by default with
% {\tt pdflatex}. 
% When invoking {\tt pdflatex}, the package {\tt breakurl} is ignored.

\nocite{*}
\bibliographystyle{eptcs}
\bibliography{generic}
\end{document}
